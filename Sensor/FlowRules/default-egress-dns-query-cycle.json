{
    "id": "default-egress-dns-query-cycle",
    "description": "Detects DNS query/response cycles initiated by internal clients to external servers.",
    "severity": "info",
    "sequence": [
        {
            "index": "Dns-Query",
            "condition": {
                "dns": { "is_response": false }
            },
            "direction": "out",
            "goto": "Dns-Response"
        },
        {
            "index": "Dns-Response",
            "condition": {
                "dns": { "is_response": true }
            },
            "direction": "in",
            "timestamp": { "nano": 5000000000 },
            "action": {
                "type": "notice",
                "message": "Egress DNS query cycle completed"
            },
            "goto": "Dns-Query"
        }
    ]
}