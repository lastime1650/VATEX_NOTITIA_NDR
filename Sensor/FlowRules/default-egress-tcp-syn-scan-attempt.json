{
    "id": "default-egress-tcp-syn-scan-attempt",
    "description": "Detects a potential TCP SYN scan attempt from an internal source, identified by a SYN probe followed by a reset (RST) response, indicating a closed port.",
    "severity": "low",
    "sequence": [
        {
            "index": "Syn-Probe",
            "condition": {
                "tcp": { "flags": ["S"] }
            },
            "direction": "out",
            "goto": "Rst-Response"
        },
        {
            "index": "Rst-Response",
            "condition": {
                "tcp": { "flags": ["R", "A"] }
            },
            "direction": "in",
            "timestamp": { "nano": 5000000000 },
            "pre": {
                "not_complete_ids": [
                    "default-egress-tcp-session-established"
                ]
            },
            "action": {
                "type": "notice",
                "message": "Potential internal TCP SYN scan detected (SYN -> RST sequence without session)"
            }
        }
    ]
}